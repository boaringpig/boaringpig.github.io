<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>TPF - Pig Management Tool</title><script src="https://cdn.tailwindcss.com"></script><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=PT+Mono&display=swap" rel="stylesheet"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css"><link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.18/main.min.css" rel="stylesheet"><script type="module" crossorigin src="./assets/index.ch3C7cBr.js"></script><link rel="stylesheet" crossorigin href="./assets/index.dASH810o.css"></head><body><div id="liveCostTracker" class="live-cost-tracker hidden"><div class="live-tracker-header"><div class="live-tracker-title">ðŸ’° Cost Tracker Running</div><div class="live-tracker-close" onclick="window.dismissLiveCostTracker()">Ã—</div></div><div class="live-tracker-content"><div class="live-tracker-time" id="liveCostTime">00:00:00</div><div class="live-tracker-cost" id="liveCostAmount">â‚¬0.00</div><div class="live-tracker-rate" id="liveCostRate">â‚¬50.00 per minute</div><div class="live-tracker-penalties" id="liveCostPenalties"></div></div></div><div class="container"><div id="loginScreen" class="login-container"><div class="login-form"><h1 class="login-title">Pig Management Tool Login</h1><div id="errorMessage" class="error-message" style="display:none"></div><div id="successMessage" class="success-message" style="display:none"></div><form id="loginForm"><div class="form-group"><label class="form-label" for="username">Username</label> <input type="text" id="username" class="form-input" required></div><div class="form-group"><label class="form-label" for="password">Password</label> <input type="password" id="password" class="form-input" required></div><div class="form-group"><label class="form-label"><input type="checkbox" id="rememberMe"> Remember Me</label></div><button type="submit" class="login-btn">Login</button></form></div></div><div id="mainApp" style="display:none"><div class="header"><div class="header-left"><h1>Pig Management Tool</h1><p>A tool to improve pig obedience.</p></div><div class="user-info"><div id="userBadge" class="user-badge"></div><div id="userPoints" class="points-badge">0 Points</div><button class="logout-btn" onclick="logout()">Logout</button><div id="connectionStatus" class="connection-status status-online">Connected</div></div></div><div class="nav-tabs"><button class="nav-tab active" onclick='switchTab("tasks")'>Tasks</button> <button class="nav-tab" onclick='switchTab("calendar")'>Calendar</button> <button class="nav-tab" onclick='switchTab("dashboard")' id="dashboardTab" style="display:none">Dashboard</button> <button class="nav-tab" onclick='switchTab("suggest")' id="suggestTab">Suggest Task</button> <button class="nav-tab" onclick='switchTab("shop")' id="shopTab">Rewards Shop</button> <button class="nav-tab" onclick='switchTab("adminSettings")' id="adminSettingsTab" style="display:none">Admin Settings</button></div><div id="tasksView" class="tab-content active"><div id="adminView" style="display:none"><div class="task-section"><div class="section-header"><h2 class="section-title">Create New Task</h2><div class="task-actions"><button id="showSpiralGeneratorBtn" class="action-btn check-btn">Create Spiral Task</button> <button id="showCostTrackerBtn" class="action-btn check-btn">Open Cost Tracker</button></div></div><div class="task-creation-form"><input type="text" id="taskInput" class="form-input" placeholder="Enter task description..." maxlength="200"><div class="form-row"><div class="form-group"><label class="form-label">Points (Reward)</label> <input type="number" id="taskPoints" class="form-input" value="10" min="1" max="100"></div><div class="form-group"><label class="form-label">Penalty Points</label> <input type="number" id="penaltyPoints" class="form-input" value="5" min="0" max="50"></div></div><div class="form-row"><div class="form-group"><label class="form-label">Due Date</label> <input type="text" id="taskDueDate" class="form-input" placeholder="Select a date and time..."></div><div class="form-group"><label class="form-label"><input type="checkbox" id="isDemerit"> Mark as Demerit</label><div id="demeritWarning" class="error-message" style="display:none;margin-top:10px">Demerit tasks will immediately deduct penalty points from the pig.</div></div></div><div class="form-row"><div class="form-group"><label class="form-label"><input type="checkbox" id="isRepeating"> Repeating Task</label></div><div class="form-group" id="repeatOptions" style="display:none"><label class="form-label">Repeat Every</label> <select id="repeatInterval" class="form-input"><option value="daily">Daily</option><option value="weekly">Weekly</option><option value="monthly">Monthly</option></select></div></div><button class="add-btn" onclick="createTask()">Create Task</button></div></div><div class="task-section"><div class="section-header"><h2 class="section-title">Suggested Tasks (Pending Approval)</h2></div><div id="suggestedTasks" class="task-list"></div></div><div class="task-section"><div class="section-header"><h2 class="section-title">Appeals Pending Review</h2></div><div id="pendingAppeals" class="task-list"></div></div><div class="task-section"><div class="section-header"><h2 class="section-title">Tasks Pending Approval</h2></div><div id="pendingTasks" class="task-list"></div></div><div class="task-section"><div class="section-header"><h2 class="section-title">All Tasks</h2><button id="refreshDataBtnAdmin" class="action-btn">Refresh Data</button></div><div id="allTasksAdmin" class="task-list"></div></div></div><div id="userView" style="display:none"><div class="task-section"><div class="section-header"><h2 class="section-title">My Tasks</h2><button id="refreshDataBtnUser" class="action-btn">Refresh Data</button></div><div id="myTasks" class="task-list"></div></div></div></div><div id="calendarView" class="tab-content"><div id="fullcalendar" class="calendar-container"></div></div><div id="dashboardView" class="tab-content"><div class="dashboard-container"><div class="dashboard-stats"><div class="stat-card"><h3>User Login Status</h3><div class="stat-number" id="userStatus">Offline</div></div><div class="stat-card"><h3>Active Tasks</h3><div class="stat-number" id="activeTasks">0</div></div><div class="stat-card"><h3>Completion Rate</h3><div class="stat-number" id="completionRate">0%</div></div><div class="stat-card"><h3>Demerits Issued</h3><div class="stat-number" id="demeritsIssuedCount">0</div></div><div class="stat-card"><h3>Active Cost Trackers</h3><div class="stat-number" id="activeCostTrackersCount">0</div></div></div><div class="user-progress"><h2>User Activity Log</h2><div id="userActivityLog" class="activity-log"></div></div><div class="user-progress"><h2>Pig Progress</h2><div id="userProgressList" class="progress-list"></div></div><div class="user-progress"><h2>Active Cost Trackers</h2><div id="activeCostTrackersList" class="activity-log"></div></div></div></div><div id="suggestView" class="tab-content"><div class="suggest-container"><h2>Suggest a Task</h2><form id="suggestForm" class="suggest-form"><div class="form-group"><label class="form-label">Task Description</label> <textarea id="suggestedTaskDescription" class="form-input" placeholder="Describe the task you'd like to suggest..." rows="4" required></textarea></div><div class="form-group"><label class="form-label">Justification</label> <textarea id="taskJustification" class="form-input" placeholder="Why is this task important or necessary?" rows="3"></textarea></div><div class="form-row"><div class="form-group"><label class="form-label">Suggested Points</label> <input type="number" id="suggestedPoints" class="form-input" value="10" min="1" max="100"></div><div class="form-group suggested-due-date-group"><label class="form-label">Suggested Due Date</label> <input type="text" id="suggestedDueDate" class="form-input" placeholder="Select a date and time..."></div></div><button type="submit" class="add-btn">Submit Suggestion</button></form><div class="my-suggestions"><h3>My Suggestions</h3><div id="mySuggestions" class="task-list"></div></div></div></div><div id="shopView" class="tab-content"><div class="shop-container"><h2>Available Rewards</h2><div id="rewardsList" class="rewards-grid"><div class="empty-state">No rewards available.</div></div><div class="my-purchases-section"><h3>My Reward Purchases</h3><div id="myRewardPurchases" class="purchase-list"><div class="empty-state">No purchases yet.</div></div></div></div></div><div id="adminSettingsView" class="tab-content"><div id="adminRewardManagement" class="task-section"><div class="section-header"><h2 class="section-title">Manage Rewards</h2></div><div class="reward-creation-form task-creation-form"><input type="hidden" id="rewardIdToEdit"> <input type="text" id="rewardTitle" class="form-input" placeholder="Reward Title" maxlength="100" required> <textarea id="rewardDescription" class="form-input" placeholder="Reward Description" rows="2"></textarea><div class="form-row"><div class="form-group"><label class="form-label">Cost (Points)</label> <input type="number" id="rewardCost" class="form-input" value="10" min="1" max="1000"></div><div class="form-group"><label class="form-label">Purchase Type</label> <select id="rewardType" class="form-input"><option value="instant">Instant Purchase</option><option value="authorized">Requires Authorization</option></select></div></div><button class="add-btn" id="saveRewardBtn">Add Reward</button> <button class="action-btn delete-btn" id="cancelEditRewardBtn" style="display:none">Cancel Edit</button></div><div class="task-section"><div class="section-header"><h2 class="section-title">Current Rewards</h2></div><div id="currentRewardsList" class="task-list"><div class="empty-state">No rewards defined.</div></div></div><div class="task-section"><div class="section-header"><h2 class="section-title">Reward System Settings</h2></div><div class="task-creation-form"><div class="form-group"><label class="form-label">Instant Purchase Limit (Total Points)</label> <input type="number" id="instantLimitInput" class="form-input" value="500" min="0"></div><div class="form-group"><label class="form-label">Limit Reset Duration (Days, 0 for Manual Only)</label> <input type="number" id="resetDurationInput" class="form-input" value="30" min="0"></div><div class="form-group"><label class="form-label"><input type="checkbox" id="requiresAuthAfterLimit" checked> Require Authorization After Limit Reached</label></div><p class="text-color-medium mb-3">Current Instant Spend: <span id="currentInstantSpendDisplay">0</span> / <span id="instantLimitDisplay">0</span> Points</p><p class="text-color-medium mb-3">Last Reset: <span id="lastResetDateDisplay">N/A</span></p><button class="add-btn" onclick="window.updateRewardSettingsUI()">Update Settings</button> <button class="action-btn check-btn" onclick="window.resetInstantPurchaseLimit()">Reset Instant Spend Now</button></div></div><div class="task-section"><div class="section-header"><h2 class="section-title">Pending Reward Authorizations</h2></div><div id="pendingAuthorizations" class="task-list"><div class="empty-state">No pending authorizations.</div></div></div></div></div><div class="stats"><div class="stat-item"><span id="totalTasksStat" class="stat-number">0</span> <span class="stat-label">Total Tasks</span></div><div class="stat-item"><span id="pendingCountStat" class="stat-number">0</span> <span class="stat-label">Pending</span></div><div class="stat-item"><span id="completedCountStat" class="stat-number">0</span> <span class="stat-label">Completed</span></div><div class="stat-item"><span id="myPointsStat" class="stat-number">0</span> <span class="stat-label">My Points</span></div></div></div></div><div id="eventModal" class="hidden fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50"><div class="bg-white rounded-lg shadow-xl p-6 w-11/12 md:w-1/2 lg:w-1/3 relative"><button id="closeModal" class="absolute top-3 right-3 text-gray-500 hover:text-gray-700 text-2xl font-bold">&times;</button><div id="modalContent"></div></div></div><div id="spiralModal" class="modal-overlay hidden"><div class="modal-content large"><button id="closeSpiralModal" class="close-modal-btn" onclick="window.hideSpiralGenerator()">&times;</button><div id="spiral-viewer"><canvas id="spiral-canvas"></canvas><div id="text-overlay"></div><div id="controls"><div class="control-group"><h3>Text Animation</h3><textarea id="text-script" placeholder="Enter your text script here. Use 'DELAY:ms' for delays, e.g.:
Hello World
DELAY:2000
This appears after 2 seconds
Another line
DELAY:1000
Final text"></textarea><div class="control-row"><label>Display Time:</label> <input type="range" id="text-interval" min="500" max="5000" value="2000"> <span class="value-display" id="text-interval-val">2000ms</span></div><div class="control-row"><label>Hold Duration:</label> <input type="range" id="text-hold" min="1000" max="8000" value="3000"> <span class="value-display" id="text-hold-val">3000ms</span></div><div class="control-row"><label>Animation Speed:</label> <input type="range" id="text-anim-speed" min="0.1" max="2" step="0.1" value="0.5"> <span class="value-display" id="text-anim-speed-val">0.5s</span></div><div class="control-row"><label>Text Size:</label> <input type="range" id="text-size" min="1" max="6" step="0.1" value="2.5"> <span class="value-display" id="text-size-val">2.5rem</span></div><div class="control-row"><label>Text Color:</label> <input type="color" id="text-color" value="#ffffff"></div><button onclick="window.spiral.startTextSequence()">Start Text Loop</button> <button onclick="window.spiral.stopTextSequence()">Stop Text Loop</button></div><div class="control-group"><h3>Spirals</h3><div class="spiral-list" id="spiral-list"></div><button onclick="window.spiral.addSpiral()">Add New Spiral</button></div><div class="control-group"><h3>Current Spiral Properties</h3><div class="control-row"><label>Speed:</label> <input type="range" id="speed" min="0.1" max="5" step="0.1" value="1"> <span class="value-display" id="speed-val">1</span></div><div class="control-row"><label>Radius:</label> <input type="range" id="radius" min="10" max="100" value="50"> <span class="value-display" id="radius-val">50%</span></div><div class="control-row"><label>Arms:</label> <input type="range" id="arms" min="1" max="20" value="3"> <span class="value-display" id="arms-val">3</span></div><div class="control-row"><label>Thickness:</label> <input type="range" id="thickness" min="1" max="20" value="3"> <span class="value-display" id="thickness-val">3</span></div><div class="control-row"><label>Color:</label> <input type="color" id="color" value="#4fc3f7"></div><div class="control-row"><label>Opacity:</label> <input type="range" id="opacity" min="0.1" max="1" step="0.1" value="0.8"> <span class="value-display" id="opacity-val">0.8</span></div><div class="control-row"><label>Time Offset:</label> <input type="range" id="time-offset" min="0" max="10" step="0.1" value="0"> <span class="value-display" id="time-offset-val">0</span></div><div class="control-row"><label>Rotation:</label> <input type="range" id="rotation" min="0" max="360" value="0"> <span class="value-display" id="rotation-val">0Â°</span></div></div><div class="control-group"><h3>Configuration</h3><div class="control-row"><button onclick="window.spiral.saveSpiralConfig()">Save Config</button> <button onclick="window.spiral.loadSpiralConfig()">Load Config</button></div><input type="file" id="config-file" accept=".json" style="display:none" onchange="window.spiral.handleSpiralConfigFile(event)"></div><div class="control-group"><h3>Global Settings</h3><div class="control-row"><label>Background:</label> <input type="color" id="bg-color" value="#000000"></div><button onclick="window.spiral.clearAllSpirals()">Clear All Spirals</button></div></div><button class="send-as-task-btn" onclick="window.spiral.sendSpiralConfigAsTask()">Send as Task</button></div></div></div><div id="costTrackerModal" class="modal-overlay hidden"><div class="modal-content"><button id="closeCostTrackerModal" class="close-modal-btn" onclick="window.hideCostTracker()">&times;</button><div id="cost-tracker-app"><h1>ðŸ’° Cost Tracker</h1><div class="main-content"><div class="tracker-section"><div class="settings"><div class="input-group"><label for="rate">Rate per unit:</label> <input type="number" id="rate" value="50" min="0" step="0.01"></div><div class="input-group"><label for="currency">Currency:</label> <select id="currency"><option value="â‚¬">Euro (â‚¬)</option><option value="Â£">Pound (Â£)</option><option value="$">Dollar ($)</option></select></div><div class="input-group"><label for="interval">Increment every:</label> <select id="interval"><option value="1000">1 Second</option><option value="60000" selected>1 Minute</option><option value="3600000">1 Hour</option></select></div></div><div class="timer-display" id="timer">00:00:00</div><div class="cost-display"><div class="cost-label">Current Cost</div><div class="cost-amount" id="currentCost">â‚¬0.00</div></div><div class="controls"><button id="startBtn">Start</button> <button id="stopBtn" disabled class="stop-btn">Stop</button> <button id="resetBtn" class="reset-btn">Reset</button> <button id="startLiveBtn" class="action-btn check-btn">Start Live Tracker</button></div></div><div class="penalties-section"><div class="penalties-header">ðŸ“‹ Additional Costs / Penalties</div><div class="penalty-input"><input type="text" id="penaltyDescription" placeholder="Description (e.g., Late delivery fee)"> <input type="number" id="penaltyAmount" placeholder="Amount" min="0" step="0.01"> <button id="addPenaltyBtn" class="add-penalty-btn">Add</button></div><div id="penaltyList"></div></div></div><div class="final-total" id="finalTotal"><div class="cost-label">Final Invoice</div><div id="billBreakdown"></div><div class="modal-actions"><button class="send-as-task-btn" onclick="window.costTracker.sendCostConfigAsTask()">Send as Task</button></div></div></div></div></div><script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script><script src="https://cdn.jsdelivr.net/npm/flatpickr"></script><script src="https://cdn.jsdelivr.net/npm/rrule@2.7.2/dist/es5/rrule.min.js"></script><script src="https://unpkg.com/@fullcalendar/core@6.1.18/index.global.min.js"></script><script src="https://unpkg.com/@fullcalendar/daygrid@6.1.18/index.global.min.js"></script><script src="https://unpkg.com/@fullcalendar/timegrid@6.1.18/index.global.min.js"></script><script src="https://unpkg.com/@fullcalendar/list@6.1.18/index.global.min.js"></script><script src="https://unpkg.com/@fullcalendar/rrule@6.1.18/index.global.min.js"></script></body></html>